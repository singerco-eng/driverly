<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Flowcred AI</title>
    <meta name="description" content="AI-powered credentialing for NEMT fleets" />
    <link rel="icon" type="image/svg+xml" href="/flowcred-icon.svg" />
    <style>
      /* Prevent flash of unstyled content - hide until theme is ready */
      .theme-loading {
        opacity: 0;
      }
      .theme-ready {
        opacity: 1;
        transition: opacity 0.15s ease-in;
      }
    </style>
    <script>
      // Apply cached theme and color mode immediately to prevent flash
      (function() {
        try {
          var root = document.documentElement;
          
          // Apply color mode immediately
          var colorMode = localStorage.getItem('driverly-color-mode') || 'dark';
          root.dataset.colorMode = colorMode;
          
          var cached = localStorage.getItem('driverly-theme-cache');
          if (cached) {
            var tokens = JSON.parse(cached);
            
            // Apply core color tokens
            if (tokens.primary) root.style.setProperty('--primary', tokens.primary);
            if (tokens.primary_foreground) root.style.setProperty('--primary-foreground', tokens.primary_foreground);
            if (tokens.secondary) root.style.setProperty('--secondary', tokens.secondary);
            if (tokens.secondary_foreground) root.style.setProperty('--secondary-foreground', tokens.secondary_foreground);
            if (tokens.accent) root.style.setProperty('--accent', tokens.accent);
            if (tokens.accent_foreground) root.style.setProperty('--accent-foreground', tokens.accent_foreground);
            if (tokens.background) root.style.setProperty('--background', tokens.background);
            if (tokens.foreground) root.style.setProperty('--foreground', tokens.foreground);
            if (tokens.card) root.style.setProperty('--card', tokens.card);
            if (tokens.card_foreground) root.style.setProperty('--card-foreground', tokens.card_foreground);
            if (tokens.muted) root.style.setProperty('--muted', tokens.muted);
            if (tokens.muted_foreground) root.style.setProperty('--muted-foreground', tokens.muted_foreground);
            if (tokens.border) root.style.setProperty('--border', tokens.border);
            if (tokens.ring) root.style.setProperty('--ring', tokens.ring);
            if (tokens.destructive) root.style.setProperty('--destructive', tokens.destructive);
            if (tokens.destructive_foreground) root.style.setProperty('--destructive-foreground', tokens.destructive_foreground);
            
            // Apply derived tokens (glow effects - subtle)
            if (tokens.primary) {
              root.style.setProperty('--shadow-glow-subtle', '0 0 6px hsl(' + tokens.primary + ' / 0.03)');
              root.style.setProperty('--shadow-glow', '0 0 10px hsl(' + tokens.primary + ' / 0.05)');
              root.style.setProperty('--shadow-glow-intense', '0 0 15px hsl(' + tokens.primary + ' / 0.08)');
            }
            if (tokens.primary && tokens.accent) {
              root.style.setProperty('--gradient-primary', 'linear-gradient(135deg, hsl(' + tokens.primary + '), hsl(' + tokens.accent + '))');
            }
          }
        } catch (e) {
          // Ignore errors - React will apply theme anyway
        }
      })();
    </script>
  </head>

  <body>
    <div id="root" class="theme-loading"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
